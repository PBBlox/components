<style>.ui-inlineproperties{position:absolute;left:0;right:0;bottom:0;top:0;z-index:90}.ui-inlineproperties-body{position:absolute;background:#FFF;left:50px;top:50px;border-radius:var(--radius);box-shadow:2px 5px 15px rgba(0,0,0,0.08);border:1px solid #E0E0E0;border-radius:var(--radius);z-index:1;transform-origin:top left}.ui-inlineproperties-item{height:22px;border-bottom:1px solid #E0E0E0;font-size:11px}.ui-inlineproperties-name{line-height:21px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;border-right:1px solid #E0E0E0;float:left;width:80px;padding:0 5px;color:#777}.ui-inlineproperties-value{margin-left:80px}.ui-inlineproperties-value input{width:100%;border:0;height:21px;line-height:21px;outline:0;border:0;margin:0;padding:0 0 0 5px;background:transparent;color:#000}.ui-inlineproperties-button{padding:8px}.ui-inlineproperties-button button{width:100%;background:#F0F0F0;color:#777;border:0;height:24px;line-height:23px;font-size:11px;border-radius:var(--radius)}.ui-inlineproperties-button button:hover{opacity:0.9}.ui-inlineproperties-colorclick{padding:3px 0 0 5px;cursor:pointer}.ui-inlineproperties-color span{width:14px;height:14px;display:block;border-radius:var(--radius)}.ui-inlineproperties-iconclick{padding:3px 0 0 6px;cursor:pointer}.ui-inlineproperties-dateclick{height:21px;line-height:21px;padding:0 5px;cursor:pointer}.ui-inlineproperties-listclick{height:21px;line-height:21px;padding:0 5px;cursor:pointer}.ui-inlineproperties-icon span{width:14px;height:14px;display:block;line-height:14px}.ui-inlineproperties-booleanclick{padding:3px 0 0 5px;cursor:pointer}.ui-inlineproperties-boolean span{width:14px;height:14px;background:#F0F0F0;display:block;border-radius:var(--radius)}.ui-inlineproperties-boolean i{display:none;color:#FFF}.ui-inlineproperties-checked span{background:var(--color);font-size:9px}.ui-inlineproperties-checked i{display:block;font-weight:bold;line-height:14px;text-align:center}.ui-dark .ui-inlineproperties-body{background:#353535;border-color:#404040;box-shadow:2px 5px 15px rgba(0,0,0,0.15);color:#FFF}.ui-dark .ui-inlineproperties-item{border-bottom-color:#404040}.ui-dark .ui-inlineproperties-name{border-right-color:#404040;color:#C0C0C0}.ui-dark .ui-inlineproperties-button button{background:#555;color:#C0C0C0}.ui-dark .ui-inlineproperties-boolean span{background:#777}.ui-dark .ui-inlineproperties-value input{color:#FFF}</style>
<script>COMPONENT('inlineproperties@1','close:Close;dateformat:[date];dirsearch:Search;width:200',function(self,config,cls){var cls2='.'+cls,renders={},parentclass,container,body;self.readonly();self.make=function(){self.aclass(cls+' hidden invisible');self.append('<div class="{0}-body"><div class="{0}-container"></div><div class="{0}-button"><button>{1}</button></div></div>'.format(cls,config.close));body=self.find(cls2+'-body');container=self.find(cls2+'-container');self.event('click',function(e){if(e.target===self.dom)self.hide()});self.event('click','button',function(){self.hide()});self.event('change','input',function(){var el=this,val=el.value,id=ATTRD(el);switch(el.getAttribute('type')){case'number':if(val)val=val.parseFloat();else val=null;break}var item=self.opt.items.findItem('id',id);item.value=val;self.opt.changed[id]=1});self.event('click',cls2+'-iconclick',function(){var el=$(this);var id=ATTRD(el);var opt={};opt.element=el;opt.empty=true;opt.callback=function(val){var span=opt.element.find('span').rclass();val&&span.aclass(val);var item=self.opt.items.findItem('id',id);item.value=val;self.opt.changed[id]=1};SETTER('icons/show',opt)});self.event('click',cls2+'-colorclick',function(){var opt={},el=$(this);var id=ATTRD(el);opt.element=el;opt.callback=function(val){opt.element.find('span').css('background-color',val);var item=self.opt.items.findItem('id',id);item.value=val;self.opt.changed[id]=1};SETTER('colorpicker/show',opt)});self.event('click',cls2+'-booleanclick',function(){var el=$(this);var id=ATTRD(el);var parent=el.closest('figure').tclass(cls+'-checked');var item=self.opt.items.findItem('id',id);item.value=parent.hclass(cls+'-checked');self.opt.changed[id]=1});self.event('click',cls2+'-dateclick',function(){var el=$(this);var id=ATTRD(el);var item=self.opt.items.findItem('id',id);var opt={};opt.element=el;opt.value=item.value;opt.callback=function(val){self.opt.changed[id]=1;item.value=val;el.text(item.value==null?'':item.value.format(config.dateformat))};SETTER('datepicker/show',opt)});self.event('click',cls2+'-listclick',function(){var el=$(this);var id=ATTRD(el);var item=self.opt.items.findItem('id',id);var opt={};opt.element=el;opt.value=item.value;opt.placeholder=item.dirsearch||config.dirsearch;opt.items=item.items2;opt.callback=function(val){self.opt.changed[id]=1;item.value=val?val.id:null;el.text(val?val.name:'')};SETTER('directory/show',opt)})};renders.string=function(){return'<input type="text" data-type="string" />'};renders.number=function(){return'<input type="number" data-type="number" />'};renders.date=function(){return'<div class="{0}-dateclick"></div>'.format(cls)};renders.boolean=function(){return'<div class="{0}-booleanclick"><span><i class="ti ti-check"></i></span></div>'.format(cls)};renders.color=function(){return'<div class="{0}-colorclick"><span></span></div>'.format(cls)};renders.icon=function(){return'<div class="{0}-iconclick"><span></span></div>'.format(cls)};renders.list=function(){return'<div class="{0}-listclick"></div>'.format(cls)};self.hide=function(){self.aclass('hidden invisible');var value={};for(var m of self.opt.items)value[m.id]=m.value;self.opt.scope&&M.scope(self.opt.scope);self.opt.callback(value,Object.keys(self.opt.changed))};self.show=function(opt){self.rclass('hidden');var builder=[];opt.changed={};opt.scope=M.scope();for(var m of opt.items){if(m.type==='bool')m.type='boolean';builder.push('<figure class="{0}-item {0}-{2}" data-id="{3}"><div class="{0}-name">{1}</div><div class="{0}-value">{4}</div></figure>'.format(cls,m.name,m.type,m.id,renders[m.type](m)))}var c=opt.class;if(parentclass&&c!==parentclass){self.rclass(parentclass);parentclass=null}if(!parentclass&&c){body.aclass(c);parentclass=c}container.html(builder.join(''));var elements=container.find('> figure');for(var m of elements){var el=$(m);var id=ATTRD(el);var item=opt.items.findItem('id',id);var value=opt.value?opt.value[id]:item.value;switch(item.type){case'number':el.find('input').val(value==null?'':value.toString());break;case'date':el.find(cls2+'-dateclick').text(value==null?'':value.format(config.dateformat));break;case'boolean':value&&el.aclass(cls+'-checked');break;case'icon':value&&el.find('span').aclass(value);break;case'list':var items=item.items;if(typeof(items)==='string')items=GET(items);item.items2=CLONE(items);var tmp=item.items2.findItem('id',value);el.find(cls2+'-listclick').html(tmp?tmp.name:'');break;case'color':value&&el.find('span').css('background-color',value);break;default:el.find('input').val(value==null?'':value.toString());break}}var target=$(opt.element);var w=opt.width||config.width,offset=target.offset();var css={};body.css('width',w);if(opt.element){switch(opt.align){case'center':css.left=Math.ceil((offset.left-w/2)+(target.innerWidth()/2));break;case'right':css.left=(offset.left-w)+target.innerWidth();break;default:css.left=offset.left;break}css.top=opt.position==='bottom'?(offset.top-body.height()-10):(offset.top+target.innerHeight()+10)}else{css.left=opt.x;css.top=opt.y}if(opt.position==='bottom')css.top+=10;else css.top-=10;if(opt.offsetX)css.left+=opt.offsetX;if(opt.offsetY)css.top+=opt.offsetY;var mw=w,mh=body.height();if(css.left<0)css.left=10;else if((mw+css.left)>WW)css.left=(WW-mw)-10;if(css.top<0)css.top=10;else if((mh+css.top)>WH)css.top=(WH-mh)-10;body.css(css);self.opt=opt;self.rclass('invisible')}});</script>